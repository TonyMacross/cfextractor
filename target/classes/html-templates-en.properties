# Header del documento HTML
html.header=<!DOCTYPE html>\
<html lang="en">\
<head>\
    <meta charset="UTF-8">\
    <meta name="viewport" content="width=device-width, initial-scale=1.0">\
    <title>${title} - ColdFusion Analysis</title>\
    <style>\
        body {\
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\
            line-height: 1.6;\
            margin: 0;\
            padding: 20px;\
            background-color: #f5f5f5;\
        }\
        .container {\
            max-width: 1400px;\
            margin: 0 auto;\
            background: white;\
            padding: 30px;\
            border-radius: 10px;\
            box-shadow: 0 0 20px rgba(0,0,0,0.1);\
        }\
        h1 {\
            color: #2c3e50;\
            text-align: center;\
            border-bottom: 3px solid #3498db;\
            padding-bottom: 10px;\
            margin-bottom: 30px;\
        }\
        h2 {\
            color: #34495e;\
            border-left: 4px solid #3498db;\
            padding-left: 15px;\
            margin-top: 30px;\
        }\
        .info-header {\
            background-color: #e3f2fd;\
            padding: 20px;\
            border-radius: 8px;\
            margin: 20px 0;\
            display: grid;\
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\
            gap: 15px;\
        }\
        .info-item {\
            display: flex;\
            align-items: center;\
        }\
        .info-label {\
            font-weight: bold;\
            color: #2c3e50;\
            margin-right: 10px;\
        }\
        .summary-card {\
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\
            color: white;\
            padding: 20px;\
            border-radius: 10px;\
            text-align: center;\
            margin: 20px 0;\
        }\
        .summary-card h3 {\
            margin: 0 0 10px 0;\
            color: white;\
        }\
        .summary-card .number {\
            font-size: 2.5em;\
            font-weight: bold;\
            margin: 10px 0;\
        }\
        table {\
            width: 100%;\
            border-collapse: collapse;\
            margin: 20px 0;\
            background: white;\
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);\
        }\
        th, td {\
            padding: 12px 15px;\
            text-align: left;\
            border-bottom: 1px solid #ddd;\
        }\
        th {\
            background-color: #3498db;\
            color: white;\
            font-weight: bold;\
            cursor: pointer;\
            user-select: none;\
        }\
        th:hover {\
            background-color: #2980b9;\
        }\
        tr:nth-child(even) {\
            background-color: #f8f9fa;\
        }\
        tr:hover {\
            background-color: #e8f4f8;\
        }\
        .code {\
            background-color: #f8f9fa;\
            border: 1px solid #e9ecef;\
            border-radius: 4px;\
            padding: 8px;\
            font-family: 'Courier New', monospace;\
            font-size: 0.9em;\
            overflow-x: auto;\
            max-height: 150px;\
            overflow-y: auto;\
            white-space: pre-wrap;\
        }\
        .file-extension {\
            background-color: #007bff;\
            color: white;\
            padding: 3px 8px;\
            border-radius: 4px;\
            font-size: 0.8em;\
            font-weight: bold;\
        }\
        .usage-list {\
            max-height: 120px;\
            overflow-y: auto;\
            font-size: 0.9em;\
            line-height: 1.4;\
        }\
        .status-badge {\
            padding: 4px 8px;\
            border-radius: 12px;\
            font-size: 0.8em;\
            font-weight: bold;\
        }\
        .status-used {\
            background-color: #d4edda;\
            color: #155724;\
        }\
        .status-unused {\
            background-color: #f8d7da;\
            color: #721c24;\
        }\
        .table-info {\
            background-color: #f8f9fa;\
            padding: 10px;\
            border-radius: 5px;\
            margin-bottom: 15px;\
            font-size: 0.9em;\
            color: #6c757d;\
        }\
    </style>\
</head>\
<body>\
    <div class="container">\
        <h1>${title}</h1>\
        <div class="info-header">\
            <div class="info-item">\
                <span class="info-label">Application Path:</span>\
                <span>${applicationPath}</span>\
            </div>\
            <div class="info-item">\
                <span class="info-label">Analysis Date:</span>\
                <span>${analysisDate}</span>\
            </div>\
            <div class="info-item">\
                <span class="info-label">Report Type:</span>\
                <span>${description}</span>\
            </div>\
        </div>

# Footer del documento HTML
html.footer=    </div>\
    <script>\
        // Add sorting functionality to tables\
        document.querySelectorAll('table').forEach(table => {\
            const headers = table.querySelectorAll('th');\
            headers.forEach((header, index) => {\
                header.addEventListener('click', () => sortTable(table, index));\
            });\
        });\
        \
        function sortTable(table, column) {\
            const tbody = table.querySelector('tbody');\
            const rows = Array.from(tbody.querySelectorAll('tr'));\
            \
            rows.sort((a, b) => {\
                const aText = a.cells[column].textContent.trim();\
                const bText = b.cells[column].textContent.trim();\
                \
                // Check if both values are numbers\
                if (!isNaN(aText) && !isNaN(bText)) {\
                    return Number(aText) - Number(bText);\
                }\
                \
                return aText.localeCompare(bText);\
            });\
            \
            rows.forEach(row => tbody.appendChild(row));\
        }\
        \
        // Highlight search terms\
        function highlightText(searchTerm) {\
            if (searchTerm.length < 2) return;\
            \
            const tables = document.querySelectorAll('table tbody');\
            tables.forEach(tbody => {\
                const rows = tbody.querySelectorAll('tr');\
                rows.forEach(row => {\
                    const cells = row.querySelectorAll('td');\
                    cells.forEach(cell => {\
                        const text = cell.textContent;\
                        if (text.toLowerCase().includes(searchTerm.toLowerCase())) {\
                            cell.style.backgroundColor = '#fff3cd';\
                        } else {\
                            cell.style.backgroundColor = '';\
                        }\
                    });\
                });\
            });\
        }\
    </script>\
</body>\
</html>

# File inventory table
html.files=<div class="summary-card">\
    <h3>ColdFusion Files Found</h3>\
    <div class="number">${totalFiles}</div>\
</div>\
<div class="table-info">\
    <strong>Note:</strong> This report shows only ColdFusion files (.cfm, .cfc, .cfml). Click column headers to sort.\
</div>\
<table>\
    <thead>\
        <tr>\
            <th>File Path</th>\
            <th>Extension</th>\
            <th>Size (bytes)</th>\
            <th>Lines</th>\
            <th>Last Modified</th>\
        </tr>\
    </thead>\
    <tbody>\
        ${fileRows}\
    </tbody>\
</table>

# File row template
files.row=<tr>\
    <td title="${relativePath}">${relativePath}</td>\
    <td><span class="file-extension">${extension}</span></td>\
    <td style="text-align: right;">${fileSize}</td>\
    <td style="text-align: right;">${lineCount}</td>\
    <td>${lastModified}</td>\
</tr>

# Query inventory table - UPDATED
html.queries=<div class="summary-card">\
    <h3>Unique SQL Query Groups</h3>\
    <div class="number">${totalQueries}</div>\
</div>\
<div class="table-info">\
    <strong>Note:</strong> This report shows unique query groups by name. Execution Count shows how many times each query is executed. File:Line column shows all locations. SQL Extracts shows each occurrence of the SQL code. Click column headers to sort.\
</div>\
<table>\
    <thead>\
        <tr>\
            <th>DB Table</th>\
            <th>Query Name</th>\
            <th>File:Line</th>\
            <th>Execution Count</th>\
            <th>Datasource</th>\
            <th>SQL Extracts</th>\
        </tr>\
    </thead>\
    <tbody>\
        ${queryRows}\
    </tbody>\
</table>

# Query row template - UPDATED
queries.row=<tr>\
    <td><span class="status-badge status-used">${dbTable}</span></td>\
    <td><strong>${queryName}</strong></td>\
    <td title="Multiple locations"><div class="usage-list">${fileLines}</div></td>\
    <td style="text-align: center;"><span class="status-badge status-used">${executionCount}</span></td>\
    <td>${datasource}</td>\
    <td><div class="code" style="max-height: 200px;">${sqlExtracts}</div></td>\
</tr>

# Function inventory table
html.functions=<div class="summary-card">\
    <h3>Functions Found</h3>\
    <div class="number">${totalFunctions}</div>\
</div>\
<div class="table-info">\
    <strong>Note:</strong> This report shows all &lt;cffunction&gt; definitions found. Usage tracking shows where functions are called.\
</div>\
<table>\
    <thead>\
        <tr>\
            <th>Function Name</th>\
            <th>File</th>\
            <th>Line</th>\
            <th>Access</th>\
            <th>Return Type</th>\
            <th>Component</th>\
            <th>Used In Files</th>\
        </tr>\
    </thead>\
    <tbody>\
        ${functionRows}\
    </tbody>\
</table>

# Function row template
functions.row=<tr>\
    <td><strong>${functionName}</strong></td>\
    <td title="${fileName}">${fileName}</td>\
    <td style="text-align: center;">${lineNumber}</td>\
    <td><span class="status-badge">${access}</span></td>\
    <td>${returnType}</td>\
    <td>${componentName}</td>\
    <td><div class="usage-list">${usedInFiles}</div></td>\
</tr>

# Component inventory table
html.components=<div class="summary-card">\
    <h3>Components Found</h3>\
    <div class="number">${totalComponents}</div>\
</div>\
<div class="table-info">\
    <strong>Note:</strong> This report shows all &lt;cfcomponent&gt; definitions and their inheritance relationships.\
</div>\
<table>\
    <thead>\
        <tr>\
            <th>Component Name</th>\
            <th>File</th>\
            <th>Line</th>\
            <th>Extends</th>\
            <th>Implements</th>\
            <th>Used In Files</th>\
        </tr>\
    </thead>\
    <tbody>\
        ${componentRows}\
    </tbody>\
</table>

# Component row template
components.row=<tr>\
    <td><strong>${componentName}</strong></td>\
    <td title="${fileName}">${fileName}</td>\
    <td style="text-align: center;">${lineNumber}</td>\
    <td>${extends}</td>\
    <td>${implements}</td>\
    <td><div class="usage-list">${usedInFiles}</div></td>\
</tr>

# Invoke inventory table
html.invokes=<div class="summary-card">\
    <h3>Component Invocations Found</h3>\
    <div class="number">${totalInvokes}</div>\
</div>\
<div class="table-info">\
    <strong>Note:</strong> This report shows all &lt;cfinvoke&gt; calls found in the application.\
</div>\
<table>\
    <thead>\
        <tr>\
            <th>Component</th>\
            <th>Method</th>\
            <th>File</th>\
            <th>Line</th>\
        </tr>\
    </thead>\
    <tbody>\
        ${invokeRows}\
    </tbody>\
</table>

# Invoke row template
invokes.row=<tr>\
    <td><strong>${component}</strong></td>\
    <td>${method}</td>\
    <td title="${fileName}">${fileName}</td>\
    <td style="text-align: center;">${lineNumber}</td>\
</tr>

# Include inventory table
html.includes=<div class="summary-card">\
    <h3>Template Includes Found</h3>\
    <div class="number">${totalIncludes}</div>\
</div>\
<div class="table-info">\
    <strong>Note:</strong> This report shows all &lt;cfinclude&gt; statements found in the application.\
</div>\
<table>\
    <thead>\
        <tr>\
            <th>Template Path</th>\
            <th>Including File</th>\
            <th>Line</th>\
        </tr>\
    </thead>\
    <tbody>\
        ${includeRows}\
    </tbody>\
</table>

# Include row template
includes.row=<tr>\
    <td><strong>${template}</strong></td>\
    <td title="${fileName}">${fileName}</td>\
    <td style="text-align: center;">${lineNumber}</td>\
</tr>

# Module inventory table
html.modules=<div class="summary-card">\
    <h3>Custom Modules Found</h3>\
    <div class="number">${totalModules}</div>\
</div>\
<div class="table-info">\
    <strong>Note:</strong> This report shows all &lt;cfmodule&gt; calls found in the application.\
</div>\
<table>\
    <thead>\
        <tr>\
            <th>Module Template</th>\
            <th>Module Name</th>\
            <th>Using File</th>\
            <th>Line</th>\
        </tr>\
    </thead>\
    <tbody>\
        ${moduleRows}\
    </tbody>\
</table>

# Module row template
modules.row=<tr>\
    <td><strong>${template}</strong></td>\
    <td>${name}</td>\
    <td title="${fileName}">${fileName}</td>\
    <td style="text-align: center;">${lineNumber}</td>\
</tr>